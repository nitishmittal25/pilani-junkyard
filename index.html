<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <!-- Google tag (gtag.js) -->
  <script src="https://www.googletagmanager.com/gtag/js?id=G-LQSN2EKWKV"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-LQSN2EKWKV');
  </script> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ReviewSnap â€” Google Play Scraper</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700;800;900&family=Fraunces:opsz,wght@9..144,600;9..144,800;9..144,900&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --sky:       #bae6fd;
      --sky-mid:   #7dd3fc;
      --sky-deep:  #0284c7;
      --mint:      #bbf7d0;
      --mint-deep: #059669;
      --peach:     #fed7aa;
      --peach-deep:#ea580c;
      --lemon:     #fef08a;
      --lemon-deep:#ca8a04;
      --lilac:     #e9d5ff;
      --lilac-deep:#7c3aed;
      --rose:      #fecdd3;
      --rose-deep: #e11d48;
      --butter:    #fef9c3;
      --ink:       #1c1917;
      --ink2:      #44403c;
      --muted:     #78716c;
      --border:    #e7e5e4;
      --card:      #ffffff;
      --bg:        #fffbf7;
    }

    html { scroll-behavior: smooth; }
    body { background: var(--bg); color: var(--ink); font-family: 'Nunito', sans-serif; min-height: 100vh; overflow-x: hidden; }

    /* â”€â”€ NAV â”€â”€ */
    nav {
      position: sticky; top: 0; z-index: 300;
      background: rgba(255,251,247,0.93);
      backdrop-filter: blur(16px);
      border-bottom: 2.5px solid var(--border);
      padding: 0 2.5rem;
      display: flex; align-items: center; justify-content: space-between;
      height: 66px;
    }
    .logo {
      font-family: 'Fraunces', serif;
      font-size: 1.6rem; font-weight: 900;
      letter-spacing: -1px; color: var(--ink);
      display: flex; align-items: center; gap: 0.5rem;
    }
    .logo-icon {
      width: 36px; height: 36px; border-radius: 10px;
      background: linear-gradient(135deg, var(--sky-mid), var(--lilac-deep));
      display: flex; align-items: center; justify-content: center;
      font-size: 1.1rem;
    }
    .logo em { font-style: normal; color: var(--sky-deep); }
    .nav-right { display: flex; align-items: center; gap: 0.8rem; }
    .nav-pill {
      background: var(--lemon); color: var(--lemon-deep);
      border-radius: 99px; padding: 0.28rem 0.8rem;
      font-size: 0.7rem; font-weight: 800; letter-spacing: 0.5px;
    }

    /* â”€â”€ HERO â”€â”€ */
    .hero {
      background: linear-gradient(160deg, var(--butter) 0%, #fce7f3 50%, var(--sky) 100%);
      padding: 5rem 2.5rem 4rem;
      position: relative; overflow: hidden; text-align: center;
    }
    .blob { position: absolute; border-radius: 50%; opacity: 0.45; animation: drift linear infinite; }
    .b1 { width:160px;height:160px;background:var(--rose);  top:-40px; left:-40px;  animation-duration:12s;animation-delay:0s; }
    .b2 { width:100px;height:100px;background:var(--mint);  bottom:20px;left:8%;    animation-duration:9s; animation-delay:1s; }
    .b3 { width:200px;height:200px;background:var(--sky);   top:-60px; right:-60px; animation-duration:14s;animation-delay:2s; }
    .b4 { width:70px; height:70px; background:var(--lemon); bottom:30px;right:12%;  animation-duration:8s; animation-delay:0.5s;}
    .b5 { width:90px; height:90px; background:var(--lilac); top:40%;   left:3%;     animation-duration:11s;animation-delay:3s; }
    .b6 { width:55px; height:55px; background:var(--peach); top:30%;   right:5%;    animation-duration:7s; animation-delay:1.5s;}
    @keyframes drift {
      0%  { transform:translateY(0) rotate(0deg); }
      33% { transform:translateY(-22px) rotate(5deg); }
      66% { transform:translateY(10px) rotate(-5deg); }
      100%{ transform:translateY(0) rotate(0deg); }
    }
    .hero-inner { position: relative; z-index: 1; max-width: 680px; margin: 0 auto; }
    .hero-badge {
      display: inline-flex; align-items: center; gap: 0.5rem;
      background: white; border: 2.5px solid var(--border);
      border-radius: 99px; padding: 0.38rem 1rem;
      font-size: 0.78rem; font-weight: 800; color: var(--ink2);
      margin-bottom: 1.8rem;
      box-shadow: 0 4px 16px rgba(0,0,0,0.07);
    }
    .pulse-dot { width:8px;height:8px;border-radius:50%;background:var(--mint-deep);animation:pulse 2s ease-in-out infinite; }
    @keyframes pulse { 0%,100%{transform:scale(1);opacity:1} 50%{transform:scale(1.5);opacity:0.5} }
    .hero h1 {
      font-family: 'Fraunces', serif;
      font-size: clamp(2.6rem,6.5vw,4.8rem);
      font-weight: 900; line-height: 1.06;
      letter-spacing: -2px; margin-bottom: 1.2rem; color: var(--ink);
    }
    .hero h1 .accent {
      background: linear-gradient(120deg, var(--sky-deep), var(--lilac-deep));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    .hero-sub { font-size:1.05rem;color:var(--muted);line-height:1.75;font-weight:500;max-width:520px;margin:0 auto 2.5rem; }
    .hero-stats {
      display: flex; justify-content: center;
      background: white; border: 2.5px solid var(--border);
      border-radius: 18px; overflow: hidden; max-width: 480px; margin: 0 auto;
      box-shadow: 0 4px 20px rgba(0,0,0,0.06);
    }
    .hstat { flex:1;padding:1.1rem 0.5rem;text-align:center;border-right:2px solid var(--border); }
    .hstat:last-child { border-right:none; }
    .hstat-num { font-family:'Fraunces',serif;font-size:1.5rem;font-weight:900;color:var(--ink); }
    .hstat-lbl { font-size:0.7rem;color:var(--muted);font-weight:700;margin-top:0.1rem;letter-spacing:0.3px; }

    /* â”€â”€ MAIN â”€â”€ */
    .main { max-width: 980px; margin: 0 auto; padding: 3rem 2rem 5rem; }
    .card { background:var(--card);border:2.5px solid var(--border);border-radius:28px;overflow:hidden;box-shadow:0 8px 40px rgba(0,0,0,0.06); }

    .card-banner {
      background: linear-gradient(120deg, var(--sky), var(--lilac), var(--mint));
      background-size: 200% 200%;
      animation: gradshift 6s ease infinite;
      padding: 2rem 2.5rem 1.8rem;
      position: relative; overflow: hidden;
    }
    @keyframes gradshift { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
    .card-banner::after { content:'â­';position:absolute;right:2rem;top:50%;transform:translateY(-50%);font-size:5rem;opacity:0.18; }
    .card-banner h2 { font-family:'Fraunces',serif;font-size:1.5rem;font-weight:900;color:var(--ink);margin-bottom:0.3rem; }
    .card-banner p  { font-size:0.88rem;color:var(--ink2);font-weight:600; }

    .card-body { padding: 2.5rem; }

    /* â”€â”€ COMPANY CHIPS â”€â”€ */
    .section-label { font-size:0.7rem;font-weight:800;letter-spacing:1.5px;text-transform:uppercase;color:var(--muted);margin-bottom:0.9rem; }
    .company-chips { display:flex;flex-wrap:wrap;gap:0.6rem;margin-bottom:2rem; }
    .chip {
      display:flex;align-items:center;gap:0.5rem;
      background:var(--bg);border:2.5px solid var(--border);
      border-radius:14px;padding:0.55rem 1rem;
      cursor:pointer;transition:all 0.18s;font-family:'Nunito',sans-serif;
    }
    .chip:hover { border-color:var(--sky-deep);background:var(--sky);transform:translateY(-2px); }
    .chip.active { border-color:var(--sky-deep);background:linear-gradient(120deg,var(--sky),var(--lilac));box-shadow:0 4px 14px rgba(2,132,199,0.2); }
    .chip-icon { font-size:1.15rem; }
    .chip-name { font-size:0.8rem;font-weight:800;color:var(--ink);line-height:1; }
    .chip-cat  { font-size:0.62rem;color:var(--muted);font-weight:600;line-height:1;margin-top:0.15rem; }

    /* â”€â”€ FORM â”€â”€ */
    .form-sep { display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;color:var(--muted);font-size:0.78rem;font-weight:700; }
    .form-sep::before, .form-sep::after { content:'';flex:1;height:2px;background:var(--border); }
    .fg { margin-bottom:1.2rem; }
    .fl { display:block;font-size:0.72rem;font-weight:800;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:0.45rem; }
    .fi, .fs {
      width:100%;background:var(--bg);border:2.5px solid var(--border);
      border-radius:13px;padding:0.78rem 1.1rem;
      color:var(--ink);font-family:'Nunito',sans-serif;
      font-size:0.92rem;font-weight:600;outline:none;transition:all 0.2s;
    }
    .fi:focus, .fs:focus { border-color:var(--sky-deep);background:white;box-shadow:0 0 0 4px rgba(2,132,199,0.1); }
    .fi::placeholder { color:#c4b5a8; }
    .frow { display:grid;grid-template-columns:1fr 1fr 1fr;gap:1rem; }

    .fetch-btn {
      width:100%;padding:1.05rem;
      background:linear-gradient(120deg,var(--sky-deep) 0%,var(--lilac-deep) 100%);
      color:white;border:none;border-radius:16px;
      font-family:'Nunito',sans-serif;font-size:1.05rem;font-weight:900;
      cursor:pointer;transition:all 0.22s;letter-spacing:0.3px;
      display:flex;align-items:center;justify-content:center;gap:0.6rem;
    }
    .fetch-btn:hover { transform:translateY(-2px);box-shadow:0 10px 28px rgba(124,58,237,0.3); }
    .fetch-btn:active { transform:translateY(0); }
    .fetch-btn:disabled { opacity:0.55;cursor:not-allowed;transform:none;box-shadow:none; }

    /* â”€â”€ STATUS â”€â”€ */
    .status-bar { display:none;align-items:center;gap:0.8rem;margin-top:1.5rem;padding:1rem 1.2rem;border-radius:14px;border:2px solid;font-weight:700;font-size:0.88rem; }
    .status-bar.loading { display:flex;background:var(--sky);border-color:var(--sky-mid);color:var(--sky-deep); }
    .status-bar.error   { display:flex;background:var(--rose);border-color:var(--rose-deep);color:var(--rose-deep); }
    .spin { width:20px;height:20px;border-radius:50%;border:3px solid rgba(2,132,199,0.2);border-top-color:var(--sky-deep);animation:rot 0.7s linear infinite;flex-shrink:0; }
    @keyframes rot { to{transform:rotate(360deg)} }

    /* â”€â”€ RESULTS â”€â”€ */
    #results { margin-top:2rem; }
    .results-header {
      background:linear-gradient(120deg,var(--mint),var(--lemon));
      border:2.5px solid var(--mint-deep);border-radius:16px;
      padding:1.1rem 1.4rem;
      display:flex;align-items:center;justify-content:space-between;
      flex-wrap:wrap;gap:0.8rem;margin-bottom:1.4rem;
    }
    .results-meta { display:flex;align-items:center;gap:0.8rem;flex-wrap:wrap; }
    .app-icon-sm  { width:44px;height:44px;border-radius:12px;object-fit:cover;border:2px solid white; }
    .app-icon-placeholder { width:44px;height:44px;border-radius:12px;background:var(--sky);display:flex;align-items:center;justify-content:center;font-size:1.4rem;border:2px solid white; }
    .results-title { font-family:'Fraunces',serif;font-size:1.05rem;font-weight:900; }
    .results-sub   { font-size:0.78rem;color:var(--mint-deep);font-weight:700;margin-top:0.1rem; }
    .export-btn {
      background:white;border:2.5px solid var(--mint-deep);color:var(--mint-deep);
      border-radius:99px;padding:0.45rem 1.1rem;font-size:0.8rem;font-weight:800;
      cursor:pointer;font-family:'Nunito',sans-serif;transition:all 0.2s;
      display:flex;align-items:center;gap:0.4rem;
    }
    .export-btn:hover { background:var(--mint-deep);color:white; }

    /* â”€â”€ REVIEW CARDS â”€â”€ */
    .rv {
      background:white;border:2.5px solid var(--border);
      border-radius:18px;padding:1.3rem 1.5rem;margin-bottom:1rem;
      animation:slideup 0.35s ease both;
      transition:border-color 0.2s,box-shadow 0.2s;
    }
    .rv:hover { border-color:var(--sky-mid);box-shadow:0 4px 16px rgba(2,132,199,0.08); }
    @keyframes slideup { from{opacity:0;transform:translateY(12px)} to{opacity:1;transform:translateY(0)} }
    .rv-top   { display:flex;align-items:flex-start;justify-content:space-between;gap:1rem;margin-bottom:0.6rem; }
    .rv-user  { display:flex;align-items:center;gap:0.7rem; }
    .rv-avatar{
      width:38px;height:38px;border-radius:50%;
      border:2px solid var(--border);background:var(--lemon);
      display:flex;align-items:center;justify-content:center;
      font-size:0.9rem;font-weight:800;color:var(--lemon-deep);flex-shrink:0;overflow:hidden;
    }
    .rv-name    { font-weight:800;font-size:0.9rem;color:var(--ink); }
    .rv-version { font-size:0.65rem;color:var(--muted);font-weight:600;margin-top:0.1rem; }
    .rv-right   { text-align:right;flex-shrink:0; }
    .rv-stars   { font-size:0.95rem;margin-bottom:0.15rem;letter-spacing:-1px; }
    .rv-date    { font-size:0.7rem;color:var(--muted);font-weight:700; }
    .rv-text    { font-size:0.87rem;color:var(--ink2);line-height:1.65;font-weight:500; }
    .rv-reply   { margin-top:0.9rem;padding:0.8rem 1rem;background:var(--butter);border-left:3px solid var(--lemon-deep);border-radius:0 10px 10px 0;font-size:0.8rem; }
    .rv-reply-label { font-weight:800;color:var(--lemon-deep);font-size:0.72rem;margin-bottom:0.3rem;letter-spacing:0.3px; }
    .rv-reply-text  { color:var(--ink2);line-height:1.6; }
    .rv-foot  { display:flex;align-items:center;justify-content:space-between;margin-top:0.7rem; }
    .rv-thumbs{ font-size:0.72rem;color:var(--muted);font-weight:700; }
    .s1{color:#ef4444} .s2{color:#f97316} .s3{color:#eab308} .s4{color:#84cc16} .s5{color:#22c55e}

    /* â”€â”€ HOW IT WORKS â”€â”€ */
    .how-section { background:linear-gradient(135deg,var(--lilac),var(--sky));border-radius:24px;padding:2.5rem;margin-top:3rem;border:2.5px solid var(--lilac-deep); }
    .how-title  { font-family:'Fraunces',serif;font-size:1.3rem;font-weight:900;margin-bottom:1.5rem; }
    .how-steps  { display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.2rem; }
    .how-step   { background:white;border-radius:16px;padding:1.3rem;border:2px solid rgba(255,255,255,0.8); }
    .how-num    { font-family:'Fraunces',serif;font-size:2rem;font-weight:900;color:var(--lilac-deep);margin-bottom:0.5rem; }
    .how-text   { font-size:0.85rem;font-weight:600;color:var(--ink2);line-height:1.6; }

    /* â”€â”€ FOOTER â”€â”€ */
    footer { background:var(--ink);color:#a8a29e;padding:2.5rem;text-align:center;font-size:0.82rem;font-weight:600; }
    footer a { color:var(--sky-mid);text-decoration:none; }
    footer a:hover { text-decoration:underline; }

    @media(max-width:700px){
      nav{padding:0 1rem;}
      .hero{padding:3.5rem 1.2rem 3rem;}
      .card-body{padding:1.5rem;}
      .card-banner{padding:1.5rem;}
      .frow{grid-template-columns:1fr;}
      .main{padding:2rem 1rem 4rem;}
      .results-header{flex-direction:column;align-items:flex-start;}
    }
    .nav-tab {
      background: none; border: 2px solid var(--border);
      border-radius: 99px; padding: 0.3rem 0.9rem;
      font-family: 'Nunito', sans-serif; font-size: 0.8rem;
      font-weight: 800; color: var(--muted); cursor: pointer;
      transition: all 0.2s;
    }
    .nav-tab.active { background: var(--ink); color: white; border-color: var(--ink); }
    .nav-tab:hover  { border-color: var(--ink); }
  </style>
</head>
<body>

<!-- NAV -->
<nav>
  <div class="logo">
    <div class="logo-icon">â­</div>
    Review<em>Snap</em>
  </div>
  <div class="nav-right">
    <span class="nav-pill">LIVE DATA</span>
    <button onclick="showTab('scraper')" id="tab-scraper" class="nav-tab active">ğŸ” Scraper</button>
    <button onclick="showTab('feedback')" id="tab-feedback" class="nav-tab">ğŸ’¬ Feedback</button>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="blob b1"></div><div class="blob b2"></div><div class="blob b3"></div>
  <div class="blob b4"></div><div class="blob b5"></div><div class="blob b6"></div>
  <div class="hero-inner">
    <div class="hero-badge">
      <span class="pulse-dot"></span>
      Real reviews from Google Play Â· No signup needed
    </div>
    <h1>Understand any app's<br/><span class="accent">reviews instantly</span></h1>
    <p class="hero-sub">Pick any Indian app company, hit fetch, and get real reviews with sentiment analysis, time-period breakdown, issues, and what users love â€” all in one place.</p>
    <div class="hero-stats">
      <div class="hstat"><div class="hstat-num">Live</div><div class="hstat-lbl">Real Data</div></div>
      <div class="hstat"><div class="hstat-num">200+</div><div class="hstat-lbl">Reviews/fetch</div></div>
      <div class="hstat"><div class="hstat-num">CSV</div><div class="hstat-lbl">Export</div></div>
      <div class="hstat"><div class="hstat-num">Free</div><div class="hstat-lbl">Always</div></div>
    </div>
  </div>
</section>

<!-- MAIN -->
<div id="page-scraper">
<div class="main">  
  <div class="card">
    <div class="card-banner">
      <h2>ğŸ” Google Play Review Scraper</h2>
      <p>Select a company, choose filters, and fetch live reviews with full analysis.</p>
    </div>
    <div class="card-body">

      <div class="section-label">Popular Indian App Companies</div>
      <div class="company-chips" id="chips"></div>

      <div class="form-sep">or enter any package ID manually</div>

      <div class="fg">
        <label class="fl">Google Play Package ID</label>
        <input class="fi" id="app-id" type="text" placeholder="e.g. com.cred.club"/>
      </div>

      <div class="frow">
        <div class="fg">
          <label class="fl">Filter by Stars</label>
          <select class="fs" id="star-filter">
            <option value="0">â­ All Ratings</option>
            <option value="1">1 Star â­</option>
            <option value="2">2 Stars â­â­</option>
            <option value="3">3 Stars â­â­â­</option>
            <option value="4">4 Stars â­â­â­â­</option>
            <option value="5">5 Stars â­â­â­â­â­</option>
          </select>
        </div>
        <div class="fg">
          <label class="fl">Sort By</label>
          <select class="fs" id="sort">
            <option value="2">Newest First</option>
            <option value="1">Most Relevant</option>
            <option value="3">Rating</option>
          </select>
        </div>
        <div class="fg">
          <label class="fl">Number of Reviews</label>
          <select class="fs" id="count" onchange="toggleCustomCount(this)">
            <option value="40">40 reviews</option>
            <option value="80">80 reviews</option>
            <option value="150" selected>150 reviews</option>
            <option value="300">300 reviews</option>
            <option value="500">500 reviews</option>
            <option value="1000">1,000 reviews</option>
            <option value="2000">2,000 reviews</option>
            <option value="5000">5,000 reviews (slow)</option>
            <option value="custom">Custom number...</option>
          </select>
          <input class="fi" id="custom-count" type="number" min="1" max="5000"
            placeholder="Enter number e.g. 750"
            style="display:none;margin-top:0.5rem"/>
        </div>
      </div>

      <button class="fetch-btn" id="fetch-btn" onclick="fetchReviews()">
        âš¡ Fetch &amp; Analyse Reviews
      </button>

      <div class="status-bar" id="status">
        <div class="spin"></div>
        <span id="status-text">Fetching reviews from Google Playâ€¦</span>
      </div>

      <div id="results"></div>

    </div>
  </div>

  <!-- HOW IT WORKS -->
  <div class="how-section">
    <div class="how-title">ğŸ”§ How ReviewSnap works</div>
    <div class="how-steps">
      <div class="how-step">
        <div class="how-num">01</div>
        <div class="how-text">Pick a company or paste any Google Play package ID. The frontend calls the backend API.</div>
      </div>
      <div class="how-step">
        <div class="how-num">02</div>
        <div class="how-text">A Python serverless function fetches real reviews using <code>google-play-scraper</code> â€” no API key needed.</div>
      </div>
      <div class="how-step">
        <div class="how-num">03</div>
        <div class="how-text">Reviews are analysed for sentiment, time-period trends, and the most mentioned words in positive vs negative reviews.</div>
      </div>
      <div class="how-step">
        <div class="how-num">04</div>
        <div class="how-text">Export everything to CSV â€” all reviews, ratings, dates, developer replies included.</div>
      </div>
    </div>
  </div>
</div>
</div>

<!-- FEEDBACK PAGE -->
<div id="page-feedback" style="display:none">
<div class="main">
  <div class="card">
    <div class="card-banner">
      <h2>ğŸ’¬ Feedback & Contact Us</h2>
      <p>Have a suggestion, found a bug, or want to say hello? We'd love to hear from you.</p>
    </div>
    <div class="card-body" style="max-width:560px;margin:0 auto;">
      <div class="fg">
        <label class="fl">Your Name</label>
        <input class="fi" id="fb-name" type="text" placeholder="e.g. Rahul Sharma"/>
      </div>
      <div class="fg">
        <label class="fl">Contact Number</label>
        <input class="fi" id="fb-contact" type="tel" placeholder="e.g. 9876543210"/>
      </div>
      <div class="fg">
        <label class="fl">Message</label>
        <textarea class="fi" id="fb-message" rows="5"
          placeholder="Tell us what you think, report a bug, or suggest a featureâ€¦"
          style="resize:vertical;line-height:1.6"></textarea>
      </div>
      <button class="fetch-btn" id="fb-btn" onclick="submitFeedback()">
        ğŸ“¨ Send Message
      </button>
      <div class="status-bar" id="fb-status" style="margin-top:1rem;">
        <span id="fb-status-text"></span>
      </div>
    </div>
  </div>
</div>
</div>

<!-- FOOTER -->  

<!-- FOOTER -->
<footer>
  <p>ReviewSnap Â· Real Google Play data Â· Built for Indian founders and product teams ğŸ‡®ğŸ‡³</p>
  <p style="margin-top:0.5rem;opacity:0.6">Free forever Â· No signup needed</p>
</footer>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONFIG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const API_URL = '/api/analyse';
// â”€â”€ Replace this URL with your Google Apps Script deployment URL â”€â”€
const FEEDBACK_URL = 'https://script.google.com/macros/s/AKfycbwY14CyHvjFAujZoz3sLYg4Dv9PlNTwF3TdXgjD322wutbHQ0zxQ7DUBDoo79DqMtA/exec';

function showTab(tab) {
  document.getElementById('page-scraper').style.display  = tab === 'scraper'  ? 'block' : 'none';
  document.getElementById('page-feedback').style.display = tab === 'feedback' ? 'block' : 'none';
  document.getElementById('tab-scraper').classList.toggle('active',  tab === 'scraper');
  document.getElementById('tab-feedback').classList.toggle('active', tab === 'feedback');
}

async function submitFeedback() {
  const name    = document.getElementById('fb-name').value.trim();
  const contact = document.getElementById('fb-contact').value.trim();
  const message = document.getElementById('fb-message').value.trim();

  if (!name || !message) {
    const bar = document.getElementById('fb-status');
    bar.className = 'status-bar error';
    document.getElementById('fb-status-text').textContent = 'Please enter your name and message.';
    return;
  }

  const btn = document.getElementById('fb-btn');
  btn.disabled = true;
  btn.innerHTML = '<div style="width:18px;height:18px;border:3px solid rgba(255,255,255,0.3);border-top-color:white;border-radius:50%;animation:rot 0.7s linear infinite;flex-shrink:0"></div> Sendingâ€¦';

  try {
    await fetch(FEEDBACK_URL, {
      method: 'POST',
      mode: 'no-cors',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name, contact, message }),
    });
    document.getElementById('fb-name').value    = '';
    document.getElementById('fb-contact').value = '';
    document.getElementById('fb-message').value = '';
    const bar = document.getElementById('fb-status');
    bar.className = 'status-bar loading';
    document.getElementById('fb-status-text').textContent = 'âœ… Message sent! We will get back to you soon.';
  } catch (err) {
    const bar = document.getElementById('fb-status');
    bar.className = 'status-bar error';
    document.getElementById('fb-status-text').textContent = 'Failed to send. Please try again.';
  } finally {
    btn.disabled = false;
    btn.innerHTML = 'ğŸ“¨ Send Message';
  }
}
  

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COMPANIES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const COMPANIES = [
  { name:'CRED',       id:'com.dreamplug.androidapp',       icon:'ğŸ’³', cat:'Fintech'        },
  { name:'PhonePe',    id:'com.phonepe.app',              icon:'ğŸ“²', cat:'Payments'         },
  { name:'Meesho',     id:'com.meesho.supply',            icon:'ğŸ›ï¸', cat:'Social Commerce'  },
  { name:'Zepto',      id:'com.zeptoconsumerapp',         icon:'âš¡', cat:'Quick Commerce'   },
  { name:'Blinkit',    id:'com.grofers.customerapp',      icon:'ğŸŸ¡', cat:'Grocery'          },
  { name:'Groww',      id:'com.nextbillion.groww',        icon:'ğŸ“ˆ', cat:'Investing'        },
  { name:'Nykaa',      id:'com.fsn.nykaa',                icon:'ğŸ’„', cat:'Beauty D2C'       },
  { name:'JioHotstar', id:'in.startv.hotstar',            icon:'ğŸ§', cat:'Entertainment'    },
  { name:'Lenskart',   id:'com.lenskart.app',             icon:'ğŸ‘“', cat:'D2C Eyewear'      },
  { name:'Swiggy',     id:'in.swiggy.android',            icon:'ğŸ”', cat:'FoodTech'         },
  { name:'Zomato',     id:'com.application.zomato',       icon:'ğŸ±', cat:'FoodTech'         },
  { name:'Razorpay',   id:'com.razorpay.payments.app',    icon:'âš¡', cat:'Fintech'          },
  { name:'Mamaearth',  id:'com.mamaearthapp',             icon:'ğŸŒ¿', cat:'Wellness D2C'     },
  { name:'Delhivery',  id:'com.delhiveryConsigneeApp',    icon:'ğŸ“¦', cat:'Logistics'        },
  { name:'Ola',        id:'com.olacabs.customer',         icon:'ğŸš•', cat:'Mobility'         },
  { name:'Juspay',     id:'io.juspay.juspayportal',       icon:'ğŸ”', cat:'Payments'         },
];

// Build custom key
function toggleCustomCount(sel) {
  const input = document.getElementById('custom-count');
  input.style.display = sel.value === 'custom' ? 'block' : 'none';
}
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BUILD COMPANY CHIPS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const chipsEl = document.getElementById('chips');
COMPANIES.forEach(c => {
  const el = document.createElement('button');
  el.className = 'chip';
  el.innerHTML = `
    <span class="chip-icon">${c.icon}</span>
    <span class="chip-info">
      <span class="chip-name">${c.name}</span>
      <span class="chip-cat">${c.cat}</span>
    </span>`;
  el.onclick = () => {
    document.querySelectorAll('.chip').forEach(b => b.classList.remove('active'));
    el.classList.add('active');
    document.getElementById('app-id').value = c.id;
  };
  chipsEl.appendChild(el);
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let lastData = null;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FETCH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function fetchReviews() {
  const appId = document.getElementById('app-id').value.trim();
  const countSel = document.getElementById('count').value;
  const count = countSel === 'custom'
    ? (parseInt(document.getElementById('custom-count').value) || 150)
    : countSel;

  if (!appId) {
    showError('Please select a company or enter a Package ID first.');
    return;
  }

  const btn = document.getElementById('fetch-btn');
  btn.disabled = true;
  btn.innerHTML = '<div style="width:18px;height:18px;border:3px solid rgba(255,255,255,0.3);border-top-color:white;border-radius:50%;animation:rot 0.7s linear infinite;flex-shrink:0"></div> Fetching from Google Playâ€¦';

  setStatus('loading', 'Connecting to Google Play â€” this takes 10â€“20 seconds for large fetchesâ€¦');
  document.getElementById('results').innerHTML = '';
  
  const rating = document.getElementById('star-filter').value;
  const sort   = document.getElementById('sort').value;
  const params = new URLSearchParams({ appId, count, rating, sort });

  try {
    const res  = await fetch(`${API_URL}?${params}`);
    const data = await res.json();

    if (!res.ok) throw new Error(data.error || `Server error ${res.status}`);

    lastData = data;
    clearStatus();
    renderResults(data);
    if (typeof gtag === 'function') {
      gtag('event', 'fetch_reviews', { app_id: appId, count: String(count) });
    }

  } catch (err) {
    if (err.message.includes('Failed to fetch') || err.message.includes('NetworkError') || err.message.includes('Load failed')) {
      showError('âš ï¸ Backend not connected. Make sure api/analyse.py is deployed on Vercel and requirements.txt is in your repo root.');
    } else {
      showError('Error: ' + err.message);
    }
  } finally {
    btn.disabled = false;
    btn.innerHTML = 'âš¡ Fetch &amp; Analyse Reviews';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER RESULTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderResults(data) {
  const {
    appName, appIcon, appRating, totalReviews, analysed,
    positive, negative, neutral, sentiment,
    topIssues, topGood, periodBreakdown, issueSummary, goodSummary,
    lastReviewDate, oldestReviewDate,
    reviews: rvList
  } = data;

  // â”€â”€ Sentiment colour + label â”€â”€
  const sentimentColor = sentiment === 'positive' ? '#059669'
                       : sentiment === 'negative' ? '#e11d48'
                       : '#ca8a04';
  const sentimentLabel = sentiment === 'positive' ? 'ğŸŸ¢ Mostly Positive'
                       : sentiment === 'negative' ? 'ğŸ”´ Mostly Negative'
                       : 'ğŸŸ¡ Mixed';

  // â”€â”€ App icon â”€â”€
  const iconHTML = appIcon
    ? `<img class="app-icon-sm" src="${appIcon}" alt="${appName}" onerror="this.style.display='none'"/>`
    : `<div class="app-icon-placeholder">ğŸ“±</div>`;

  // â”€â”€ Results header â”€â”€
  const headerHTML = `
    <div class="results-header">
      <div class="results-meta">
        ${iconHTML}
        <div>
          <div class="results-title">${escHtml(appName)}</div>
          <div class="results-sub">
            ${analysed} reviews analysed
            ${appRating ? ' Â· ' + parseFloat(appRating).toFixed(1) + 'â­ on Play Store' : ''}
            ${totalReviews ? ' Â· ' + Number(totalReviews).toLocaleString('en-IN') + ' total' : ''}
          </div>
        </div>
      </div>
      <button class="export-btn" onclick="exportCSV()">â¬‡ Export CSV</button>
    </div>`;

  // â”€â”€ Sentiment summary boxes â”€â”€
  const sentimentHTML = `
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:0.8rem;margin-bottom:1.5rem;">
      <div style="background:#bbf7d0;border:2px solid #059669;border-radius:16px;padding:1rem;text-align:center;">
        <div style="font-family:'Fraunces',serif;font-size:2rem;font-weight:900;color:#059669">${positive}</div>
        <div style="font-size:0.72rem;font-weight:800;color:#059669">POSITIVE (4â˜…â€“5â˜…)</div>
      </div>
      <div style="background:#fecdd3;border:2px solid #e11d48;border-radius:16px;padding:1rem;text-align:center;">
        <div style="font-family:'Fraunces',serif;font-size:2rem;font-weight:900;color:#e11d48">${negative}</div>
        <div style="font-size:0.72rem;font-weight:800;color:#e11d48">NEGATIVE (1â˜…â€“2â˜…)</div>
      </div>
      <div style="background:#fef08a;border:2px solid #ca8a04;border-radius:16px;padding:1rem;text-align:center;">
        <div style="font-family:'Fraunces',serif;font-size:2rem;font-weight:900;color:#ca8a04">${neutral}</div>
        <div style="font-size:0.72rem;font-weight:800;color:#ca8a04">NEUTRAL (3â˜…)</div>
      </div>
      <div style="background:#e9d5ff;border:2px solid #7c3aed;border-radius:16px;padding:1rem;text-align:center;">
        <div style="font-size:0.92rem;font-weight:900;color:${sentimentColor};margin-bottom:0.3rem">${sentimentLabel}</div>
        <div style="font-size:0.72rem;font-weight:800;color:#7c3aed">OVERALL SENTIMENT</div>
      </div>
    </div>`;

  // â”€â”€ Period breakdown table â”€â”€
  let periodHTML = '';
  if (periodBreakdown && Object.keys(periodBreakdown).length) {
    const rows = Object.entries(periodBreakdown).map(([label, d]) => {
      const avgColor = d.avg >= 4 ? '#059669' : d.avg >= 3 ? '#ca8a04' : '#e11d48';
      return `
        <tr style="border-bottom:1px solid #e7e5e4;">
          <td style="padding:0.7rem 0.8rem;font-weight:800;font-size:0.85rem;white-space:nowrap">
          ${label}
          <div style="font-size:0.65rem;color:#78716c;font-weight:600;margin-top:0.15rem">${d.dateRange || ''}</div>
          </td>
          <td style="padding:0.7rem 0.8rem;text-align:center;font-weight:700">${Number(d.total).toLocaleString('en-IN')}</td>
          <td style="padding:0.7rem 0.8rem;text-align:center;font-weight:900;color:${avgColor}">${d.avg}</td>
          <td style="padding:0.7rem 0.8rem;text-align:center;font-weight:700;color:#059669">${d['5star']}</td>
          <td style="padding:0.7rem 0.8rem;text-align:center;font-weight:700;color:#84cc16">${d['4star']}</td>
          <td style="padding:0.7rem 0.8rem;text-align:center;font-weight:700;color:#ca8a04">${d['3star']}</td>
          <td style="padding:0.7rem 0.8rem;text-align:center;font-weight:700;color:#f97316">${d['2star']}</td>
          <td style="padding:0.7rem 0.8rem;text-align:center;font-weight:700;color:#e11d48">${d['1star']}</td>
        </tr>`;
    }).join('');

    periodHTML = `
      <div style="background:white;border:2.5px solid #e7e5e4;border-radius:18px;margin-bottom:1.5rem;overflow:hidden;">
        <div style="background:linear-gradient(120deg,#bae6fd,#e9d5ff);padding:1rem 1.4rem;">
          <div style="font-family:'Fraunces',serif;font-weight:900;font-size:1rem;">ğŸ“… Rating Breakdown by Time Period</div>
          <div style="font-size:0.78rem;color:#475569;font-weight:600;margin-top:0.2rem;">How ratings have shifted over time â€” based on reviews fetched</div>
        </div>
        <div style="overflow-x:auto;">
          <table style="width:100%;border-collapse:collapse;font-family:'Nunito',sans-serif;">
            <thead>
              <tr style="background:#fafaf9;border-bottom:2px solid #e7e5e4;">
                <th style="padding:0.6rem 0.8rem;text-align:left;font-size:0.7rem;font-weight:800;color:#78716c;letter-spacing:1px;text-transform:uppercase">Period</th>
                <th style="padding:0.6rem 0.8rem;text-align:center;font-size:0.7rem;font-weight:800;color:#78716c;letter-spacing:1px;text-transform:uppercase">Reviews</th>
                <th style="padding:0.6rem 0.8rem;text-align:center;font-size:0.7rem;font-weight:800;color:#78716c;letter-spacing:1px;text-transform:uppercase">Avg â­</th>
                <th style="padding:0.6rem 0.8rem;text-align:center;font-size:0.7rem;font-weight:800;color:#059669">5â˜…</th>
                <th style="padding:0.6rem 0.8rem;text-align:center;font-size:0.7rem;font-weight:800;color:#84cc16">4â˜…</th>
                <th style="padding:0.6rem 0.8rem;text-align:center;font-size:0.7rem;font-weight:800;color:#ca8a04">3â˜…</th>
                <th style="padding:0.6rem 0.8rem;text-align:center;font-size:0.7rem;font-weight:800;color:#f97316">2â˜…</th>
                <th style="padding:0.6rem 0.8rem;text-align:center;font-size:0.7rem;font-weight:800;color:#e11d48">1â˜…</th>
              </tr>
            </thead>
            <tbody>${rows}</tbody>
          </table>
        </div>
      </div>`;
  }

  // â”€â”€ Issues & Good Points â”€â”€
  const maxIssue = (topIssues && topIssues.length) ? topIssues[0].count : 1;
  const issueHTML = (topIssues || []).map(({ phrase, count }) => `
    <div style="margin-bottom:0.65rem;">
      <div style="display:flex;justify-content:space-between;font-size:0.8rem;font-weight:700;margin-bottom:0.22rem;">
        <span style="text-transform:capitalize">${escHtml(phrase)}</span>
        <span style="color:#e11d48;flex-shrink:0;margin-left:0.5rem">${count}Ã—</span>
      </div>
      <div style="background:#e7e5e4;border-radius:99px;height:7px;">
        <div style="background:linear-gradient(90deg,#fecdd3,#e11d48);width:${Math.max(4,(count/maxIssue*100)).toFixed(0)}%;height:7px;border-radius:99px;transition:width 0.5s;"></div>
      </div>
    </div>`).join('');

  const maxGood = (topGood && topGood.length) ? topGood[0].count : 1;
  const goodHTML = (topGood || []).map(({ phrase, count }) => `
    <div style="margin-bottom:0.65rem;">
      <div style="display:flex;justify-content:space-between;font-size:0.8rem;font-weight:700;margin-bottom:0.22rem;">
        <span style="text-transform:capitalize">${escHtml(phrase)}</span>
        <span style="color:#059669;flex-shrink:0;margin-left:0.5rem">${count}Ã—</span>
      </div>
      <div style="background:#e7e5e4;border-radius:99px;height:7px;">
        <div style="background:linear-gradient(90deg,#bbf7d0,#059669);width:${Math.max(4,(count/maxGood*100)).toFixed(0)}%;height:7px;border-radius:99px;transition:width 0.5s;"></div>
      </div>
    </div>`).join('');

  const themesHTML = `
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1.5rem;">
      <div style="background:white;border:2.5px solid #fecdd3;border-radius:18px;padding:1.4rem;">
        <div style="font-family:'Fraunces',serif;font-weight:900;font-size:0.95rem;margin-bottom:0.3rem;">âš ï¸ Top Issues</div>
        <div style="font-size:0.72rem;color:#78716c;font-weight:600;margin-bottom:1rem;">Most mentioned words in 1â˜…â€“2â˜… reviews</div>
        ${issueSummary ? `<div style="font-size:0.8rem;color:#78716c;line-height:1.6;background:#fff1f2;padding:0.7rem;border-radius:10px;margin-bottom:1rem">${escHtml(data.issueSummary)}</div>` : ''}
        ${issueHTML || '<div style="color:#78716c;font-size:0.85rem;font-weight:600">No negative reviews in this set</div>'}
      </div>
      <div style="background:white;border:2.5px solid #bbf7d0;border-radius:18px;padding:1.4rem;">
        <div style="font-family:'Fraunces',serif;font-weight:900;font-size:0.95rem;margin-bottom:0.3rem;">âœ… What Users Love</div>
        <div style="font-size:0.72rem;color:#78716c;font-weight:600;margin-bottom:1rem;">Most mentioned words in 4â˜…â€“5â˜… reviews</div>
        ${goodSummary ? `<div style="font-size:0.8rem;color:#78716c;line-height:1.6;background:#f0fdf4;padding:0.7rem;border-radius:10px;margin-bottom:1rem">${escHtml(data.goodSummary)}</div>` : ''}
        ${goodHTML || '<div style="color:#78716c;font-size:0.85rem;font-weight:600">No positive reviews in this set</div>'}  
      </div>
    </div>`;

  // â”€â”€ Individual review cards â”€â”€
  const cardHTML = (rvList || []).map((r, i) => {
    const stars    = 'â˜…'.repeat(r.score) + 'â˜†'.repeat(5 - r.score);
    const initials = (r.userName || '?').split(' ').map(w => w[0]).join('').slice(0,2).toUpperCase();
    const dateStr  = r.date ? new Date(r.date).toLocaleDateString('en-IN',{day:'numeric',month:'short',year:'numeric'}) : '';
    const reply    = r.replyText
      ? `<div class="rv-reply"><div class="rv-reply-label">ğŸ¢ Developer Reply</div><div class="rv-reply-text">${escHtml(r.replyText)}</div></div>`
      : '';
    return `
      <div class="rv" style="animation-delay:${Math.min(i,15)*0.04}s">
        <div class="rv-top">
          <div class="rv-user">
            <div class="rv-avatar">${initials}</div>
            <div>
              <div class="rv-name">${escHtml(r.userName || 'Anonymous')}</div>
              ${r.version ? `<div class="rv-version">v${r.version}</div>` : ''}
            </div>
          </div>
          <div class="rv-right">
            <div class="rv-stars s${r.score}">${stars}</div>
            <div class="rv-date">${dateStr || 'Date unavailable'}</div>
          </div>
        </div>
        <div class="rv-text">${r.text ? escHtml(r.text) : '<span style="color:#c4b5a8;font-style:italic;font-size:0.82rem">No review text provided</span>'}</div>
        ${dateStr ? `<div style="font-size:0.7rem;color:#78716c;font-weight:700;margin-top:0.4rem;">ğŸ“… ${dateStr}</div>` : ''}
        ${reply}
        ${r.thumbsUp > 0 ? `<div class="rv-foot"><span class="rv-thumbs">ğŸ‘ ${r.thumbsUp} ${r.thumbsUp === 1 ? 'person' : 'people'} found this helpful</span></div>` : ''}
      </div>`;
  }).join('');

  // â”€â”€ Assemble everything â”€â”€
  document.getElementById('results').innerHTML = `
    ${headerHTML}
    ${sentimentHTML}
    ${periodHTML}
    ${themesHTML}
    <div style="font-family:'Fraunces',serif;font-weight:900;font-size:1rem;margin-bottom:1rem;">
      ğŸ“ All Reviews
      <span style="font-family:'Nunito',sans-serif;font-size:0.8rem;font-weight:600;color:#78716c">(${(rvList||[]).length} shown)</span>
    </div>
    ${cardHTML || '<div style="color:#78716c;padding:1rem;font-weight:600">No reviews to display.</div>'}
  `;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXPORT CSV
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function exportCSV() {
  if (!lastData || !lastData.reviews || !lastData.reviews.length) {
    alert('No data to export yet. Fetch reviews first.');
    return;
  }

  const { appName, reviews } = lastData;

  const headers = [
    'User Name', 'Star Rating', 'Review Date', 'Review Text',
    'Developer Reply', 'Reply Date', 'Helpful Votes', 'App Version'
  ];

   const rows = reviews.map(r => [
    csvCell(r.userName),
    r.score,
    r.date ? new Date(r.date).toLocaleDateString('en-IN') : '',
    csvCell(r.text),
    csvCell(r.replyText || ''),
    r.replyDate ? new Date(r.replyDate).toLocaleDateString('en-IN') : '',
    r.thumbsUp !== undefined ? r.thumbsUp : 0,
    csvCell(r.version),
  ]); 


  const oldestDate = lastData.oldestReviewDate || '';
  const newestDate = lastData.lastReviewDate || '';
  const dateRangeRow = [`"Reviews from: ${oldestDate} to ${newestDate}"`, '', '', '', '', '', '', ''];
  const csv = [dateRangeRow, headers, ...rows].map(row => row.join(',')).join('\n');
  const blob = new Blob(['\uFEFF' + csv], { type: 'text/csv;charset=utf-8;' }); // BOM for Excel
  const url  = URL.createObjectURL(blob);
  const a    = document.createElement('a');
  a.href     = url;
  a.download = `${(appName || 'reviews').replace(/\s+/g,'_')}_${new Date().toISOString().slice(0,10)}.csv`;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function csvCell(val) {
  if (val === null || val === undefined) return '""';
  const str = String(val).trim();
  return '"' + str.replace(/"/g, '""') + '"';
}  

function escHtml(str) {
  return String(str)
    .replace(/&/g,'&amp;')
    .replace(/</g,'&lt;')
    .replace(/>/g,'&gt;')
    .replace(/"/g,'&quot;');
}

function setStatus(type, msg) {
  const bar = document.getElementById('status');
  bar.className = 'status-bar ' + type;
  document.getElementById('status-text').textContent = msg;
}

function clearStatus() {
  document.getElementById('status').className = 'status-bar';
}

function showError(msg) {
  setStatus('error', msg);
}

// Enter key support
document.getElementById('app-id').addEventListener('keydown', e => {
  if (e.key === 'Enter') fetchReviews();
});
</script>
</body>
</html>
